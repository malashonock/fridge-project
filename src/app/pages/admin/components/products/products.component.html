<h1>Manage products</h1>

<div class="controls">
  <button mat-fab matTooltip="Add new product" class="add-product-btn">
    <mat-icon>add</mat-icon>
  </button>

  <mat-form-field
    class="search-box"
    appearance="outline"
    subscriptSizing="dynamic"
  >
    <mat-label>Search products</mat-label>
    <input
      #searchInput
      matInput
      [formControl]="searchControl"
      id="search-products"
      name="search-products"
      placeholder="Search in product name or description"
    />
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>
</div>

<div class="table-container">
  <table mat-table [dataSource]="(products$ | async) || []">
    <ng-container matColumnDef="actions">
      <th
        mat-header-cell
        *matHeaderCellDef
        [attr.rowspan]="2"
        class="align-center"
      >
        Actions
      </th>
      <td mat-cell *matCellDef="let product" class="align-center">
        <button mat-icon-button matTooltip="Edit product">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Delete product">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <ng-container matColumnDef="name" sticky>
      <th mat-header-cell *matHeaderCellDef [attr.rowspan]="2">Product name</th>
      <td mat-cell *matCellDef="let product">{{ product.name }}</td>
    </ng-container>

    <ng-container matColumnDef="price">
      <th
        mat-header-cell
        *matHeaderCellDef
        class="align-right"
        [attr.rowspan]="2"
      >
        Price, BYN
      </th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.price | currency : "BYN" : "" : "1.2-2" : "en-US" }}
      </td>
    </ng-container>

    <ng-container matColumnDef="weight">
      <th
        mat-header-cell
        *matHeaderCellDef
        class="align-right"
        [attr.rowspan]="2"
      >
        Weight
      </th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.weight.value + " " + product.weight.unit }}
      </td>
    </ng-container>

    <ng-container matColumnDef="shelfLife">
      <th
        mat-header-cell
        *matHeaderCellDef
        class="align-right"
        [attr.rowspan]="2"
      >
        Shelf life
      </th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.shelfLife }}
      </td>
    </ng-container>

    <ng-container matColumnDef="calories">
      <th
        mat-header-cell
        *matHeaderCellDef
        class="align-right"
        [attr.rowspan]="2"
      >
        Energy value, kcal
      </th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.kiloCalories }}
      </td>
    </ng-container>

    <ng-container matColumnDef="nutrients">
      <th
        mat-header-cell
        *matHeaderCellDef
        [attr.colspan]="3"
        class="align-center"
      >
        Nutrients, g
      </th>
    </ng-container>

    <ng-container matColumnDef="protein">
      <th mat-header-cell *matHeaderCellDef class="align-right">Protein</th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.nutrients.protein }}
      </td>
    </ng-container>

    <ng-container matColumnDef="fat">
      <th mat-header-cell *matHeaderCellDef class="align-right">Fat</th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.nutrients.fat }}
      </td>
    </ng-container>

    <ng-container matColumnDef="carbs">
      <th mat-header-cell *matHeaderCellDef class="align-right">Carbs</th>
      <td mat-cell *matCellDef="let product" class="align-right">
        {{ product.nutrients.carbs }}
      </td>
    </ng-container>

    <tr
      mat-header-row
      *matHeaderRowDef="
        [
          'actions',
          'name',
          'price',
          'weight',
          'shelfLife',
          'calories',
          'nutrients'
        ];
        sticky: true
      "
    ></tr>
    <tr
      mat-header-row
      *matHeaderRowDef="['protein', 'fat', 'carbs']; sticky: true"
    ></tr>
    <tr
      mat-row
      *matRowDef="
        let row;
        columns: [
          'actions',
          'name',
          'price',
          'weight',
          'shelfLife',
          'calories',
          'protein',
          'fat',
          'carbs'
        ]
      "
    ></tr>
  </table>
</div>
